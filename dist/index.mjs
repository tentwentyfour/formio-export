import it from"lodash";import n from"lodash";var x={verifyProperties(o,e){return e=n.isPlainObject(e)?e:{},o=n.isPlainObject(o)?o:{},n.forEach(e,(t,r)=>{if(t.hasOwnProperty("default")&&!o.hasOwnProperty(r)&&(o[r]=t.default),t.required&&n.isNil(o[r]))throw new Error(`[FormioExportUtils] invalid property (${r} is required)`);if(t.hasOwnProperty("type")&&o.hasOwnProperty(r)&&!!!n.find(n.isArray(t.type)?t.type:[t.type],l=>x.isOfType(o[r],l)))throw new Error(`[FormioExportUtils] invalid property (${r} type is invalid)`)}),o},isOfType(o,e){switch(e){case null:return n.isNull(o);case void 0:return n.isUndefined(o);case String:return n.isString(o);case Number:return n.isNumber(o);case Boolean:return n.isBoolean(o);case Array:return n.isArray(o);case Object:return n.isPlainObject(o);case Element:return n.isElement(o)||n.isObject(o)&&o.nodeType>0;case Function:return n.isFunction(o);case Date:return n.isDate(o);case RegExp:return n.isRegExp(o);case Error:return n.isError(o);case Symbol:return n.isSymbol(o);default:return console.warn("[FormioExportUtils] type not implemented"),!1}},isFormioForm(o={}){return n.isPlainObject(o)&&n.isArray(o.components)&&o.display==="form"},isFormioWizard(o={}){return n.isPlainObject(o)&&n.isArray(o.components)&&o.display==="wizard"},isFormioSubmission(o={}){return n.isPlainObject(o)&&n.isPlainObject(o.data)&&o.hasOwnProperty("_id")},getValue(o,e){let t=r=>{if(n.isPlainObject(r)){if(n.has(r,e))return r[e];let i=null;return n.forOwn(r,l=>{let m=t(l);return n.isNil(m)?!0:(i=m,!1)}),i}return null};return x.isFormioSubmission(o)?t(o.data):t(o)},interpolate(o,e){let t={evaluate:/\{%(.+?)%\}/g,interpolate:/\{\{(.+?)\}\}/g,escape:/\{\{\{(.+?)\}\}\}/g};try{return n.template(o,t)(e)}catch(r){return console.warn("Error interpolating template",r,o,e),null}},eachComponent(o,e,t,r,i){o&&(r=r||"",o.forEach(l=>{let m=l.columns&&Array.isArray(l.columns),p=l.rows&&Array.isArray(l.rows),f=l.components&&Array.isArray(l.components),h=!1,c=l.key?r?`${r}.${l.key}`:l.key:"";i&&(l.parent=n.clone(i),delete l.parent.components,delete l.parent.componentMap,delete l.parent.columns,delete l.parent.rows),(t||l.tree||!m&&!p&&!f)&&(h=e(l,c));let V=()=>l.key&&(["datagrid","container","editgrid"].includes(l.type)||l.tree)?c:l.key&&l.type==="form"?`${c}.data`:r;h||(m?l.columns.forEach(N=>x.eachComponent(N.components,e,t,V(),i?l:null)):p?l.rows.forEach(N=>N.forEach(lt=>x.eachComponent(lt.components,e,t,V(),i?l:null))):f&&x.eachComponent(l.components,e,t,V(),i?l:null))}))},createElement(o,...e){let t=document.createElement(o),r={};return e[0]&&typeof e[0]=="object"&&(r=e[0],e=e.slice(1)),r.style&&typeof r.style=="object"&&(r.style=n.map(r.style,(i,l)=>`${l}:${i}`).join(";")),r.hasOwnProperty("innerHTML")?(t.innerHTML=r.innerHTML,delete r.innerHTML):n.forEach(e,i=>{n.isString(i)?t.appendChild(document.createTextNode(i)):(n.isElement(i)||n.isObject(i)&&i.nodeType>0)&&t.appendChild(i)}),n.forEach(r,(i,l)=>{t.setAttribute(l,i)}),t}},s=x;import Pe from"lodash";import u from"lodash";import nt from"lodash";var S=(o,e)=>{if(e&&e.input){let t=s.createElement("div",{class:`formio-component ${e.type}-component`,id:Math.random().toString(36).substring(7)}),r=s.createElement("div",{class:"col component-label"},e.label),i=s.createElement("div",{class:"col component-value"},e.formatValue());return!e.hideLabel&&(!e.inDataGrid||e.dataGridLabel)&&(r.className+=e._options.equalCols?"":" col-sm-3",i.className+=e._options.equalCols?"":" col-sm-9",t.appendChild(r)),t.appendChild(i),nt.isElement(o)&&o.appendChild(t),t}return null};var D=o=>{let e={width:o._baseWidth,height:o._baseHeight};if(o.label)switch(o.labelPosition){case"top":case"bottom":e.height++;break;default:e.width++}return e};var L=class o{constructor(e,t,r={}){if(!(this instanceof o))return new o(e,t);if(this.type="",this._options=u.cloneDeep(r),this._value=null,this._dims={},this._baseWidth=1,this._baseHeight=1,u.isObject(e)&&e.hasOwnProperty("type")){let i=u.cloneDeep(e);for(let l in i)this[l]=i[l]}if(t===null)return this;u.isPlainObject(t)?(this._value=s.getValue({data:t},this.key),u.isNil(this._value)&&!this.input&&(this._value=u.cloneDeep(t))):this._value=t}getLabel(){return this.legend||this.title||this.label||this.key}emptyValue(){return u.isNil(this._options.emptyValue)?"":this._options.emptyValue}toHtml(e){return S(e,this)}getDimensions(){return this._dims=D(this),this._dims}hasComponents(){let e=this.columns&&Array.isArray(this.columns),t=this.rows&&Array.isArray(this.rows),r=this.components&&Array.isArray(this.components);return e||t||r}updateDimensions(){this._width=1,this._height=1}createComponent(e,t,r){return b.create(e,t,r)}formatValue(){return u.isNil(this._value)?this.emptyValue():this._value.toString()}isLayoutComponent(){return!1}},a=L;var U=class extends a{constructor(e,t,r){super(e,t,r)}formatValue(){return Pe.isEmpty(this._value)?this.emptyValue():Pe.isString(this._value)?this._value:this._value.toString()}},d=U;var A=class extends d{constructor(e,t,r){super(e,t,r)}},Oe=A;var $=class extends d{constructor(e,t,r){super(e,t,r)}},Fe=$;var T=class extends d{constructor(e,t,r){super(e,t,r)}},Ve=T;var B=class extends d{constructor(e,t,r){super(e,t,r)}},Ne=B;import at from"lodash";var M=class extends a{constructor(e,t,r){super(e,t,r)}formatValue(){return at.isNil(this._value)?this.emptyValue():this._value.toLocaleString()}},w=M;var q=class extends w{constructor(e,t){super(e,t)}},Se=q;import De from"lodash";var G=class extends a{constructor(e,t,r){super(e,t,r)}formatValue(){return De.isNil(this._value)?this.emptyValue():De.isString(this._value)?this._value.replace("T"," ").split(".")[0]+" UTC":this._value}},Le=G;import Ue from"lodash";var k=class extends a{constructor(e,t,r){super(e,t,r)}formatValue(){if(Ue.isNil(this._value))return this.emptyValue();if(Ue.isString(this._value)){let e=this._value.split("/");return this.dayFirst?[e[2],e[1],e[0]].join("-"):[e[2],e[0],e[1]].join("-")}return this._value}},Ae=k;var W=class extends d{constructor(e,t,r){super(e,t,r)}},$e=W;import Te from"lodash";var R=class extends a{constructor(e,t,r){super(e,t,r)}formatValue(){return Te.isNil(this._value)?this.emptyValue():Te.isObject(this._value)?this._value.formatted_address:this._value}},Be=R;var z=class extends a{constructor(e,t,r){super(e,t,r)}formatValue(){return this._value?"Yes":"No"}},Me=z;import qe from"lodash";var X=class extends a{constructor(e,t,r){super(e,t,r)}formatValue(){if(qe.isNil(this._value))return this.emptyValue();let e=qe.find(this.values,t=>t.value===this._value);return e?e.label:this._value}},Ge=X;import C from"lodash";import ke from"lodash";var j=(o,e)=>{if(e&&e.input){let t=s.createElement("div",{class:`formio-component ${e.type}-component`,id:Math.random().toString(36).substring(7)}),r=s.createElement("div",{class:"col component-label"},e.label),i=s.createElement("div",{class:"col component-value"});return ke.forEach(e.formatValues(),l=>{let m=s.createElement("p",{class:"component-item"});m.innerHTML=l,i.appendChild(m)}),!e.hideLabel&&(!e.inDataGrid||e.dataGridLabel)&&(r.className+=" col-sm-3",i.className+=" col-sm-9",t.appendChild(r)),t.appendChild(i),ke.isElement(o)&&o.appendChild(t),t}return null};var I=class extends a{constructor(e,t,r){super(e,t,r)}toHtml(e){return j(e,this)}formatValue(e){if(C.isNil(e))return a.emptyValue;let t=C.find(this.values,r=>r.value===e);return t?t.label:e}formatValues(){if(C.isNil(this._value))return[];let e=[];return C.forEach(this._value,(t,r)=>{t&&e.push(this.formatValue(r))}),e}},We=I;import _ from"lodash";import Re from"lodash";var Y=(o,e)=>{if(e&&e.input){let t=s.createElement("div",{class:`formio-component ${e.type}-component`,id:Math.random().toString(36).substring(7)}),r=s.createElement("div",{class:"col component-label"},e.label),i=s.createElement("div",{class:"col component-value"}),l=e.formatValues();return Re.forEach(l,m=>{let p=s.createElement("div",{class:"component-item",innerHTML:m});i.appendChild(p)}),!e.hideLabel&&(!e.inDataGrid||e.dataGridLabel)&&(r.className+=" col-sm-3",i.className+=" col-sm-9",t.appendChild(r)),t.appendChild(i),Re.isElement(o)&&o.appendChild(t),t}return null};var K=class extends a{constructor(e,t,r){super(e,t,r),this.multiple||(this._value=[this._value])}toHtml(e){return Y(e,this)}formatValues(){if(_.isNil(this._value))return this.emptyValue();let e=[];return _.forEach(this._value,t=>{e.push(this.formatValue(t))}),e}formatValue(e){if(_.isNil(e))return this.emptyValue();switch(this.dataSrc){case"url":return e;case"custom":case"resource":return _.isPlainObject(e)?s.interpolate(this.template,{item:e}):e;case"values":case"json":let t=this.valueProperty||"value",r=_.find(this.data[this.dataSrc],i=>i[t]===e);return _.isPlainObject(r)?s.interpolate(this.template,{item:r}):e;default:return e}}},H=K;import P from"lodash";var J=class extends H{constructor(e,t,r){super(e,t,r)}formatValues(){if(P.isNil(this._value))return this.emptyValue();let e=[];return P.forEach(this._value,t=>{e.push(this.formatValue(t))}),e}formatValue(e){return P.isNil(e)?this.emptyValue():P.isPlainObject(e)?s.interpolate(this.template,{item:e}):e}},ze=J;import g from"lodash";import Xe from"lodash";var Q=(o,e)=>{if(e&&e.input){let t=s.createElement("div",{class:`formio-component ${e.type}-component card`,id:Math.random().toString(36).substring(7)}),r=s.createElement("div",{class:"component-label card-header"},e.label),i=s.createElement("div",{class:"component-value card-body"}),l=e.formatValues();return Xe.forEach(l,m=>{let p=s.createElement("div",{class:"row survey-question"},s.createElement("div",{class:"col-sm-9 text-bold"},m.question),s.createElement("div",{class:"col-sm-3"},m.option));i.appendChild(p)}),!e.hideLabel&&(!e.inDataGrid||e.dataGridLabel)&&t.appendChild(r),t.appendChild(i),Xe.isElement(o)&&o.appendChild(t),t}return null};var Z=class extends a{constructor(e,t,r){super(e,t,r)}toHtml(e){return Q(e,this)}formatValue(e,t){if(g.isNil(e)||g.isNil(t))return this.emptyValue();let r={};return g.forEach(this.questions,i=>{i.value===t&&(r.question=i.label)}),g.forEach(this.values,i=>{i.value===e&&(r.option=i.label)}),r}formatValues(){if(g.isNil(this._value))return this.emptyValue();let e=[];return g.forEach(this._value,(t,r)=>{e.push(this.formatValue(t,r))}),e}},je=Z;import ee from"lodash";var te=(o,e)=>{if(e&&e.input){let t=s.createElement("div",{class:`formio-component ${e.type}-component`,id:Math.random().toString(36).substring(7)}),r=s.createElement("div",{class:"col col-sm-3 component-label"},e.label),i=s.createElement("div",{class:"col col-sm-9 component-value"});return ee.forEach(e._value,l=>{ee.isObject(l)&&(l.type.indexOf("image/")===0?i.appendChild(s.createElement("img",{src:l.url,class:"img-responsive"})):i.innerHTML=`${l.name} (${l.size/1024} KB)`)}),t.appendChild(r),t.appendChild(i),ee.isElement(o)&&o.appendChild(t),t}return null};var re=class extends a{constructor(e,t,r){super(e,t,r)}toHtml(e){return te(e,this)}},O=re;var oe=class extends O{constructor(e,t,r){super(e,t,r),this._value&&(this._value=[{storage:"base64",type:"image/png",url:this._value}])}},Ie=oe;import Ke from"lodash";import Ye from"lodash";var ie=(o,e)=>{if(e&&e.components){let t=s.createElement("div",{class:`formio-component ${e.type}-component card`,id:Math.random().toString(36).substring(7)}),r=s.createElement("div",{class:"component-label card-header"},e.getLabel()),i=s.createElement("div",{class:"component-value card-body"});return(!e.inDataGrid||e.dataGridLabel)&&t.appendChild(r),Ye.forEach(e.components,l=>{l&&(e.inDataGrid&&(l._options.equalCols=!0),l.toHtml(i))}),t.appendChild(i),Ye.isElement(o)&&o.appendChild(t),t}return null};var se=class extends a{constructor(e,t,r){if(super(e,t,r),this.components&&Ke.isArray(this.components)){let i=[];Ke.forEach(this.components,l=>{i.push(this.createComponent(l,t,r))}),this.components=i}}toHtml(e){return ie(e,this)}},y=se;import ae from"lodash";import E from"lodash";var le=(o,e)=>{if(e&&e.components){let t=s.createElement("div",{class:`formio-component grid-component ${e.type}-component card`,id:Math.random().toString(36).substring(7)}),r=s.createElement("div",{class:"component-label card-header"},e.getLabel()),i=s.createElement("div",{class:"component-value card-body"});if(e.numRows<e.numCols)i.className+=" grid-transpose",E.forEach(e.components,(m,p)=>{let f=s.createElement("div",{class:"row grid-row"},s.createElement("div",{class:"col col-sm-3 grid-cell text-bold"},m.legend||m.title||m.label));E.forEach(e.rows,h=>{let c=s.createElement("div",{class:"col grid-cell"});h[p].toHtml(c),f.appendChild(c)}),i.appendChild(f)});else{let m=s.createElement("div",{class:"row grid-row grid-header"});E.forEach(e.rows[0],p=>{p&&m.appendChild(s.createElement("div",{class:"col grid-cell"},p.getLabel()))}),i.appendChild(m),E.forEach(e.rows,p=>{let f=s.createElement("div",{class:"row grid-row"});E.forEach(p,h=>{if(h){let c=s.createElement("div",{class:"col grid-cell"});h.toHtml(c),f.appendChild(c)}}),i.appendChild(f)})}return!e.hideLabel&&(!e.inDataGrid||e.dataGridLabel)&&t.appendChild(r),t.appendChild(i),E.isElement(o)&&o.appendChild(t),t}return null};import mt from"lodash";var ne=o=>{let e={width:o._baseWidth,height:o._baseHeight},t=0;return mt.forEach(o.components,r=>{if(r){let i=r.getDimensions();e.width+=i.width}}),e.width+=t,e};var me=class extends a{constructor(e,t,r){super(e,t,r),this.numCols=Array.isArray(this.components)?this.components.length:0,this.numRows=Array.isArray(this._value)?this._value.length:0,this.rows=[],ae.isArray(this._value)&&ae.forEach(this._value,i=>{let l=[];ae.forEach(this.components,m=>{l.push(this.createComponent(m,i[m.key],r))}),this.rows.push(l)})}getDimensions(){return ne(this)}toHtml(e){return le(e,this)}},Je=me;var pe=class extends a{constructor(e,t,r){super(e,t,r),console.log(this)}},Qe=pe;import Ze from"lodash";var de=(o,e)=>{if(e&&e.components){let t=s.createElement("div",{class:`formio-component ${e.type}-component`,id:Math.random().toString(36).substring(7)});if(t.appendChild(s.createElement("h1",{class:"form-title"},e.title)),e._options.submission&&(e._options.submission.hasOwnProperty("owner")&&t.appendChild(s.createElement("div",{class:"row"},s.createElement("div",{class:"col text-right text-bold"},"submission owner:"),s.createElement("div",{class:"col text-left"},e._options.submission.owner))),e._options.submission.hasOwnProperty("id")&&t.appendChild(s.createElement("div",{class:"row"},s.createElement("div",{class:"col text-right text-bold"},"submission id:"),s.createElement("div",{class:"col text-left"},e._options.submission.id))),e._options.submission.hasOwnProperty("modified"))){let r=e._options.submission.modified.replace("T"," ").split(".")[0]+" UTC";t.appendChild(s.createElement("div",{class:"row"},s.createElement("div",{class:"col text-right text-bold"},"modified:"),s.createElement("div",{class:"col text-left"},r)))}return t.appendChild(s.createElement("br")),Ze.forEach(e.components,r=>{r&&r.toHtml(t)}),Ze.isElement(o)&&o.appendChild(t),t}return null};import pt from"lodash";var ce=o=>{let e={width:o._baseWidth,height:o._baseHeight},t=0;return pt.forEach(o.components,r=>{if(r){let i=r.getDimensions();t<i.width&&(t=i.width),e.height+=i.height}}),e.width+=t,e};var fe=class extends y{constructor(e,t,r={}){super(e,t,r)}getDimensions(){return ce(this)}toHtml(e){return de(e,this)}},et=fe;import _e from"lodash";import ue from"lodash";var he=(o,e)=>{if(e&&e.columns){let t=s.createElement("div",{class:`formio-component ${e.type}-component`,id:Math.random().toString(36).substring(7)});return t.className+=e._options.ignoreLayout?" no-layout":"",ue.forEach(e.columns,r=>{let i=`col col-sm-${r.width}`;r.offset&&(i+=` col-sm-offset-${r.offset}`),r.push&&(i+=` col-sm-push-${r.push}`),r.pull&&(i+=` col-sm-pull-${r.pull}`);let l=s.createElement("div",{class:i});ue.forEach(r.components,m=>{m.toHtml(e._ignoreLayout?t:l)}),e._ignoreLayout||t.appendChild(l)}),ue.isElement(o)&&o.appendChild(t),t}return null};var xe=o=>{let e={width:o._baseWidth,height:o._baseHeight};for(let t=0;t<o.columns.length;t++){let r=o.columns[t].components,i=0,l=0;for(let m=0;m<r.length;m++){let p=r[m].getDimensions();i+=p.width||0,l+=p.height||0}e.width+=i,e.height+=l}return e};var ge=class extends a{constructor(e,t,r){super(e,t,r),this.columns&&_e.isArray(this.columns)&&_e.forEach(this.columns,i=>{let l=[];_e.forEach(i.components,m=>{l.push(this.createComponent(m,t))}),i.components=l})}getDimensions(){return this._dims=xe(this),this._dims}toHtml(e){return he(e,this)}},tt=ge;var ye=class extends y{constructor(e,t,r){super(e,t,r)}},F=ye;var Ee=class extends F{constructor(e,t,r){super(e,t,r)}},rt=Ee;var v=class extends a{constructor(e,t,r){super(e,t,r)}toHtml(e){return null}};var ve={textfield:d,textarea:Oe,email:Fe,password:Ve,phoneNumber:Ne,number:w,currency:Se,datetime:Le,day:Ae,time:$e,address:Be,checkbox:Me,radio:Ge,selectboxes:We,select:H,resource:ze,survey:je,file:O,signature:Ie,container:y,datagrid:Je,editgrid:Qe,columns:tt,panel:F,fieldset:rt,unknown:v,form:et,create:(o,e,t)=>{let r=null;if(o)ve.hasOwnProperty(o.type)?r=new ve[o.type](o,e,t):r=new v(o,e,t);else return null;return r}},b=ve;var ot=s.createElement("style",{type:"text/css"},'.card,.col{position:relative}.card,body{background-color:#fff}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-size:.9rem;font-weight:400;line-height:1.5;color:#212529;text-align:left}.card-header,#formio__export .formio-component.grid-component>.component-value .grid-header,.text-bold{font-weight:700}.card-header,.text-center{text-align:center}*,::after,::before{box-sizing:border-box}.row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-8px;margin-left:-8px}.col{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%;width:100%;min-height:1px;padding-right:15px;padding-left:15px}.card{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;min-width:0;word-wrap:break-word;background-clip:border-box;border:none;border-radius:0}.card-header{padding:.75rem 1.25rem;margin-bottom:0;background-color:rgba(0,0,0,.03);border-bottom:1px solid rgba(0,0,0,.125)}.card-body{-ms-flex:1 1 auto;flex:1 1 auto}@media (min-width:576px){.col-sm-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-sm-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}}.text-right{text-align:right}.text-left{text-align:left}.form-title,#formio__export .formio-component.signature-component>.component-value{text-align:center}#formio__export{border:1px solid #ddd;font-family:Lato;max-width:790px}#formio__export .formio-component:not(.no-layout){border-top:1px solid #ddd;min-height:32px;display:flex;flex-direction:row}#formio__export>.formio-component:first-child{border-top:none}#formio__export .formio-component.no-layout{flex-direction:column}#formio__export .formio-component.no-layout>.col{padding:0;border-top:1px solid #ddd}#formio__export .formio-component.columns-component>.col>.formio-component,#formio__export .formio-component>.component-value.card-body.grid-transpose>.grid-row:first-child{border-top:none}#formio__export .formio-component:not(.card)>.component-label{border-right:1px solid #ddd;font-weight:700;padding:8px}#formio__export .formio-component.card>.component-label{border-right:none}#formio__export .formio-component>.component-value{padding:8px}#formio__export .formio-component>.component-value>.component-item{display:block}#formio__export .formio-component>.component-value>img{max-width:250px}#formio__export .formio-component:not(.survey-component):not(.grid-component)>.component-value.card-body{padding:0}#formio__export .formio-component>.component-value.card-body.grid-transpose{padding:0 8px}.form-title{text-transform:uppercase}#formio__export .formio-component.form-component{flex-direction:column}#formio__export .formio-component.currency-component>.component-value::before{content:"$"}#formio__export .formio-component.columns-component.no-layout{flex:columns}#formio__export .formio-component.columns-component>.col:not(:last-child)>.formio-component{border-right:1px solid #ddd}#formio__export .formio-component.grid-component>.component-value{padding:8px}#formio__export .formio-component.grid-component>.component-value .grid-row:not(.grid-header){border-top:1px solid #ddd}#formio__export .formio-component.card>.card-body>.formio-component:first-child,#formio__export .formio-component.container-component>.component-value>.formio-component:first-child,#formio__export .formio-component.grid-component>.component-value .grid-row>.grid-cell>.formio-component{border-top:none}#formio__export .formio-component.grid-component>.component-value .grid-row>.grid-cell{padding:0}#formio__export .formio-component.grid-component>.component-value .grid-header>.grid-cell{padding:8px}#formio__export .formio-component.grid-component>.component-value.grid-transpose>.row>.col:first-child{padding:8px;border-right:1px solid #ddd}#formio__export .formio-component.container-component>.component-value{padding:0}#formio__export .formio-component.card,#formio__export .formio-component.grid-component{flex-direction:column}#formio__export .formio-component.grid-component>.card-body,#formio__export .formio-component.survey-component .component-value>.survey-question>*{padding:8px}');var be=o=>new Promise((e,t)=>{try{let r=s.createElement("div",{id:"formio__export"},ot);o.toHtml(r),e(r)}catch(r){console.error(r),t(r)}});import dt from"html2pdf.js";var we=(o={})=>new Promise((e,t)=>{try{o=s.verifyProperties(o,{source:{type:Element,required:!0},download:{type:Boolean,default:!1}}),dt().set({html2canvas:o.html2canvas}).from(o.source).save(o.filename).then(e,t)}catch(r){console.error(r),t(r)}});var Ce=(o={})=>new Promise((e,t)=>{try{throw new Error("[FormioExport] method not implemented")}catch(r){console.error(r),t(r)}});var He=class o{constructor(e,t,r={}){if(!(this instanceof o))return new o(e,t);this.component=null,this.data={},this.options={},r.hasOwnProperty("formio")&&(this.options=it.cloneDeep(r.formio)),r.hasOwnProperty("component")?this.component=r.component:e&&(this.component=e),r.hasOwnProperty("data")?this.data=r.data:it.isNil(t)||(this.data=t),s.isFormioSubmission(this.data)&&(this.options.submission={id:this.data._id,owner:this.data.owner,modified:this.data.modified},this.data=this.data.data),this.component?((s.isFormioForm(this.component)||s.isFormioWizard(this.component))&&(this.component.type="form",this.component.display="form"),this.component=b.create(e||this.component,this.data,this.options)):this.component||console.warn(this.constructor.name,"no component defined")}toHtml(){return new Promise((e,t)=>{try{be(this.component).then(r=>e(r))}catch(r){t(r)}})}toPdf(e={}){return new Promise((t,r)=>{try{this.toHtml().then(i=>{we(Object.assign(e,{source:i,html2canvas:{scrollX:0,scrollY:0}})).then(l=>t(l))})}catch(i){r(i)}})}toXlsx(e={}){return new Promise((t,r)=>{try{Ce(e).then(i=>t(i))}catch(i){r(i)}})}static toHtml(e){return new Promise((t,r)=>{try{e=s.verifyProperties(e,{component:{type:Object,required:!0},formio:{type:Object}}),new o(e.component,e.data,e.formio).toHtml().then(i=>{t(i)})}catch(i){console.error(i),r(i)}})}static toPdf(e){return new Promise((t,r)=>{try{e=s.verifyProperties(e,{component:{type:Object,required:!0},formio:{type:Object},config:{type:Object,default:{filename:`export-${Math.random().toString(36).substring(7)}.pdf`}}}),new o(e.component,e.data,e.formio).toPdf(e.config).then(i=>{t(i)})}catch(i){console.error(i),r(i)}})}static toXlsx(e){return new Promise((t,r)=>{try{e=s.verifyProperties(e,{component:{type:Object,required:!0},formio:{type:Object},config:{type:Object}}),new o(e.component,e.data,e.formio).toXlsx(e.config).then(i=>{t(i)})}catch(i){console.error(i),r(i)}})}},st=He;var Ti=st;export{st as FormioExport,Ti as default};
